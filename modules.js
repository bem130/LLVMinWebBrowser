var LLVM={LINKAGES:set("private","linker_private","linker_private_weak","linker_private_weak_def_auto","internal","available_externally","linkonce","common","weak","appending","extern_weak","linkonce_odr","weak_odr","externally_visible","dllimport","dllexport","unnamed_addr","thread_local"),VISIBILITIES:set("default","hidden","protected"),PARAM_ATTR:set("noalias","signext","zeroext","inreg","sret","nocapture","nest"),FUNC_ATTR:set("hidden","nounwind","define","inlinehint","{"),CALLING_CONVENTIONS:set("ccc","fastcc","coldcc","cc10","x86_fastcallcc","x86_stdcallcc","cc11"),ACCESS_OPTIONS:set("volatile","atomic"),INVOKE_MODIFIERS:set("alignstack","alwaysinline","inlinehint","naked","noimplicitfloat","noinline","alwaysinline attribute.","noredzone","noreturn","nounwind","optsize","readnone","readonly","ssp","sspreq"),SHIFTS:set("ashr","lshr","shl"),PHI_REACHERS:set("branch","switch","invoke"),EXTENDS:set("sext","zext"),INTRINSICS_32:set("_llvm_memcpy_p0i8_p0i8_i64","_llvm_memmove_p0i8_p0i8_i64","_llvm_memset_p0i8_i64")};LLVM.GLOBAL_MODIFIERS=set(keys(LLVM.LINKAGES).concat(["constant","global","hidden"]));var Debugging={handleMetadata:function(a){for(var b=a.length-1;b>=0;b--){if(/^!\d+ = metadata .*/.exec(a[b])){Debugging.processMetadata(a);break}}},processMetadata:function(c){var p={};var a={};var z={};var y={};var r=new RegExp(/^  .*, !dbg !(\d+) *$/);var q=new RegExp(/^  .*, !dbg !(\d+) *; .*$/);var o=new RegExp(/^!(\d+) = metadata !{i32 (\d+), (?:i32 \d+|null), metadata !(\d+), .*}$/);var n=new RegExp(/^!(\d+) = metadata !{i32 \d+, (?:i32 \d+|metadata !\d+), (?:i32 \d+|null), (?:i32 \d+|null), metadata !(\d+), (?:i32 \d+|null)}.*/);var x=new RegExp(/^!(\d+) = metadata !{i32 \d+, (?:metadata !\d+|i32 \d+|null), metadata !(\d+).*$/);var v=new RegExp(/^!(\d+) = metadata !{i32 \d+, (?:metadata !\d+|null), metadata !"[^"]*", metadata !(\d+)[^\[]*.*$/);var u=new RegExp(/^!(\d+) = metadata !{i32 \d+, (?:i32 \d+|null), (?:i32 \d+|null), metadata !"[^"]*", metadata !"[^"]*", metadata !"[^"]*", metadata !(\d+),.*$/);var j=new RegExp(/^!(\d+) = metadata !{i32 \d+, metadata !"([^"]+)", metadata !"([^"]*)", (metadata !\d+|null)}.*$/);var g=new RegExp(/^!(\d+) = metadata !{\w+\d* !?(\d+)[^\d].*$/);var k=new RegExp(/^!llvm.dbg.[\w\.]+ = .*$/);var h=new RegExp(/^!(\d+) = metadata !{.*$/);var f=new RegExp(/^  (tail )?call void \@llvm.dbg.\w+\(metadata .*$/);for(var w=0;w<c.length;w++){var e=c[w];e=e.replace(/; +\[debug line = \d+:\d+\]/,"");var d=false;if(f.exec(e)){c[w]=";";continue}var b=r.exec(e)||q.exec(e);if(b){p[w+1]=b[1];c[w]=e.replace(/, !dbg !\d+/,"");continue}b=o.exec(e);if(b){a[b[1]]=b[2];z[b[1]]=b[3];c[w]=";";continue}b=n.exec(e)||x.exec(e)||v.exec(e)||u.exec(e);if(b){z[b[1]]=b[2];c[w]=";";continue}b=j.exec(e);if(b){y[b[1]]=b[2];c[w]=";";continue}b=g.exec(e)||k.exec(e)||h.exec(e);if(b){c[w]=";";continue}c[w]=d?";":e}this.llvmLineToSourceLine={};this.llvmLineToSourceFile={};for(var t in p){var s=p[t];this.llvmLineToSourceLine[t]=a[s];dprint("metadata","starting to recurse metadata for: "+s);while(!y[s]){dprint("metadata","recursing metadata, at: "+s);s=z[s];assert(s,"Confused as to parent metadata for llvm #"+t+", metadata !"+s)}this.llvmLineToSourceFile[t]=y[s]}this.on=true},clear:function(){this.llvmLineToSourceLine={};this.llvmLineToSourceFile={};this.on=false},getComment:function(a){if(!this.on){return null}return a in this.llvmLineToSourceLine?" //@line "+this.llvmLineToSourceLine[a]+' "'+this.llvmLineToSourceFile[a]+'"':""},getAssociatedSourceFile:function(a){if(!this.on){return null}return a in this.llvmLineToSourceLine?this.llvmLineToSourceFile[a]:null},getIdentifier:function(c){if(!this.on){return null}if(c===undefined){c=Framework.currItem.lineNum;assert(c!==undefined)}var b=false;var a;while(c>=0){var a=this.llvmLineToSourceFile[c];if(a){break}c--;b=true}if(!a){return"UNKNOWN"}return a.split("/").slice(-1)[0]+":"+(b?"~":"")+this.llvmLineToSourceLine[c]}};var PreProcessor={eliminateUnneededIntrinsics:function(b){for(var c=0;c<b.length;c++){var a=b[c];if(/call void @llvm.lifetime.(start|end)\(i\d+ -1,.*/.exec(a)){b[c]=";"}}}};var Variables={globals:{},indexedGlobals:{},nextIndexedOffset:0};var Types={types:{},fatTypes:{},flipTypes:function(){var a=this.fatTypes;this.fatTypes=this.types;this.types=a},structMetadata:{},cleanForRuntime:function(){values(this.types).forEach(function(a){delete a.intertype;delete a.name_;delete a.lineNum;delete a.lines;delete a.needsFlattening;delete a.JS});keys(this.types).forEach(function(b){var a=b.replace("%struct.","").replace("%class.");if(a===b){return}if(a in this.types){return}this.types[a]=this.types[b]},this)},needAnalysis:{},preciseI64MathUsed:(PRECISE_I64_MATH==2)};var Functions={implementedFunctions:{},indexedFunctions:{},nextIndex:2,blockAddresses:{},getIndex:function(b){if(phase!="post"&&singlePhase){this.indexedFunctions[b]=0;return"{{{ FI_"+b+" }}}"}else{var a=this.indexedFunctions[b];if(!a){a=this.nextIndex;this.nextIndex+=2;this.indexedFunctions[b]=a}return a.toString()}},generateIndexing:function(){var vals=zeros(this.nextIndex);for(var ident in this.indexedFunctions){vals[this.indexedFunctions[ident]]=ident}for(var i=0;i<vals.length;i++){while(1){var varData=Variables.globals[vals[i]];if(!(varData&&varData.resolvedAlias)){break}vals[i]=vals[+varData.resolvedAlias||eval(varData.resolvedAlias)]}}var indices=vals.toString().replace('"',"");if(BUILD_AS_SHARED_LIB){return"FUNCTION_TABLE.push.apply(FUNCTION_TABLE, ["+indices+"]);"}else{return"FUNCTION_TABLE = ["+indices+']; Module["FUNCTION_TABLE"] = FUNCTION_TABLE;'}}};var LibraryManager={library:null,loaded:false,load:function(){if(this.library){return}var libraries=["library.js","library_browser.js","library_sdl.js","library_gl.js","library_glut.js","library_xlib.js","library_egl.js","library_gc.js","library_jansson.js"].concat(additionalLibraries);for(var i=0;i<libraries.length;i++){eval(processMacros(preprocess(read(libraries[i]))))}this.loaded=true},getRootIdent:function(c){if(!this.library){return null}var a=LibraryManager.library[c];if(!a){return null}var b=c;while(typeof a==="string"){b=a;a=LibraryManager.library[a]}return b},isStubFunction:function(b){var a=LibraryManager.library[b.substr(1)];return typeof a==="function"&&a.toString().replace(/\s/g,"")==="function(){}"&&!(b in Functions.implementedFunctions)}};function cDefine(a){return a in C_DEFINES?C_DEFINES[a]:("0 /* XXX missing C define "+a+" */")}var PassManager={serialize:function(){if(phase=="pre"){print("\n//FORWARDED_DATA:"+JSON.stringify({Types:Types,Variables:Variables,Functions:Functions}))}else{if(phase=="funcs"){print("\n//FORWARDED_DATA:"+JSON.stringify({Types:{preciseI64MathUsed:Types.preciseI64MathUsed},Functions:{blockAddresses:Functions.blockAddresses,indexedFunctions:Functions.indexedFunctions}}))}}},load:function(b){var c=JSON.parse(b);for(var a in c.Types){Types[a]=c.Types[a]}for(var a in c.Variables){Variables[a]=c.Variables[a]}for(var a in c.Functions){Functions[a]=c.Functions[a]}}};